<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PagePop Wallet</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸª™ PagePop Wallet</h1>
      <button id="connectBtn">ì§€ê°‘ ì—°ê²°</button>
    </header>

    <section id="walletSection" class="hidden">
      <div class="info">
        <p><strong>ì£¼ì†Œ:</strong> <span id="walletAddress"></span></p>
        <p><strong>ì”ì•¡:</strong> <span id="walletBalance"></span> ETH</p>
      </div>

      <div class="transfer">
        <h2>í† í° ì „ì†¡</h2>
        <input type="text" id="toAddress" placeholder="ë°›ëŠ” ì£¼ì†Œ" />
        <input type="text" id="amount" placeholder="ETH ìˆ˜ëŸ‰" />
        <button id="sendBtn">ì „ì†¡</button>
        <p id="txStatus"></p>
      </div>
    </section>
  </div>

  <script>
    let web3;
    const connectBtn = document.getElementById('connectBtn');
    const walletSection = document.getElementById('walletSection');
    const walletAddress = document.getElementById('walletAddress');
    const walletBalance = document.getElementById('walletBalance');
    const sendBtn = document.getElementById('sendBtn');

    connectBtn.onclick = async () => {
      if (window.ethereum) {
        try {
          await window.ethereum.request({ method: 'eth_requestAccounts' });
          web3 = new Web3(window.ethereum);
          const accounts = await web3.eth.getAccounts();
          const balance = await web3.eth.getBalance(accounts[0]);
          walletAddress.textContent = accounts[0];
          walletBalance.textContent = web3.utils.fromWei(balance, 'ether');
          walletSection.classList.remove('hidden');
        } catch (err) {
          alert('ì§€ê°‘ ì—°ê²° ì‹¤íŒ¨: ' + err.message);
        }
      } else {
        alert('MetaMaskë¥¼ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.');
      }
    };

    sendBtn.onclick = async () => {
      const to = document.getElementById('toAddress').value;
      const value = document.getElementById('amount').value;
      const accounts = await web3.eth.getAccounts();

      web3.eth.sendTransaction({
        from: accounts[0],
        to,
        value: web3.utils.toWei(value, 'ether')
      })
      .then(tx => {
        document.getElementById('txStatus').textContent = 'ì „ì†¡ ì„±ê³µ: ' + tx.transactionHash;
      })
      .catch(err => {
        document.getElementById('txStatus').textContent = 'ì „ì†¡ ì‹¤íŒ¨: ' + err.message;
      });
    };
  </script>
</body>
</html>
